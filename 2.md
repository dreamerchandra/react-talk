








# WTF is LCP!

- Largest Contentful Paint (LCP) says when the web page is likely loaded
- It test your user's patience

























# Website Problem
![Build Size](1/build-size.png)
![Network](1/network.png)

JS size: 47.6 MB ü§Ø
Used JS size: 17.1 MB (36%) üò≥
Total API calls: 10 api calls ü´°

Math: 
> Download time @ 30Mbps: 12.7 sec
> Compile: 50ms/MB
> execute: 400ms/MB
> Compile time: 47.6 * 0.05 = 2.38 sec
> Execute time: 17.1 * 0.4 = 6.84 sec
> Total time: 12.7 + 2.38 + 6.84 = 21.92 sec
API calls should start at 21.92th sec.

User/Account Specific API calls: 3-5 sec.
> We have 7 such API calls. and our slowest API is 950ms
Redux setup is done at 25th sec.

Page Specific API calls: 5 sec.
> We have 3 such API calls. and our slowest API is 2.5 sec

To load the page, it takes ~40 seconds (under good conditions)


- How to fix it? (Hint: Don't over-lazy load everything)















# ü§ì Demo

- [What happens before LCP](3/simple-website.html)
- Performance Tab analysis
- Coverage Tab insights









# üìù Recap?

- ![JS execution pipeline](3/compile.png)
- Roughly 50% of time is spent in compiling and executing JS. (450ms/MB)
















# What's the trick!
- [Mock live](/mock-live/index.html)

- No overuse of lazy loading, avoid waterfall loading
- Fetch APIs in web worker while downloading JS in parallel
- Compile all JS in one go for better optimization
- While JS is executing, get API responses from worker thread
- ![Code frequency](3/code-frequency.png)













# Our stats
![Build Size](1/build-size.png)
![Network](1/network.png)

JS size: 47.6 MB ü§Ø
Used JS size: 17.1 MB (36%) üò≥
API calls: 17 api calls ü´°

Math: 
> Download time @ 30Mbps: 12.7 sec
> Compile: 50ms/MB
> execute: 400ms/MB
> Compile time: 47.6 * 0.05 = 2.38 sec
> Execute time: 17.1 * 0.4 = 6.84 sec
> Total time: 12.7 + 2.38 + 6.84 = 21.92 sec
API calls should start at 21.92th sec.

Our Slowest API is 950ms
Yutttttt LCP @ 21.92sec üßê

If JS is cached, LCP drops to 8-9 seconds! ü•≥

























# Coverage benchmark üéØ 
![Youtube network stats](1/yt-stats.png)
![Gmail](1/gmail.png)







 














# Do and Don't
- ![Don't lazy load/code split everything](3/waterfall.png)
- Use coverage tabs, to remove unused JS.
- SVG's probably in your main bundle. Lazy load it or change the format.
- webp < jpeg < png < (svg | gif)

- Shipping source maps doesn't affect runtime performance but costs CDN bandwidth and CI/CD resources.
- Use web workers for heavy computations/API calls


- Use CDN to serve static assets and cache it
- Don't cache HTML itself.
- Use HTTP/2 for better multiplexing









# ü§° Don't get fooled by DevTools LCP

- LCP only tells half the story. 
- Your users need the whole page to be interactive; not just the largest paint.
- [How to measure the full page when its loaded?](3/simple-website.html)




# Real-World Performance Monitoring

## Browser Performance Extension
- [Chrome DevTools Performance Extension](https://developer.chrome.com/docs/devtools/performance/extension)
- Monitor real user interactions and performance metrics

## Datadog Integration for Production Monitoring

### Setting Up Performance Tracking
```javascript
// Initialize Datadog RUM (Real User Monitoring)
import { datadogRum } from '@datadog/browser-rum';

// Custom performance tracking
const trackPageLoad = (pageName, loadTime) => {
  datadogRum.addTiming('custom.page_load_complete', loadTime, {
    page_name: pageName,
    user_type: 'authenticated',
  });
};

// Track specific performance metrics
const trackLCPImprovement = (beforeLCP, afterLCP) => {
  const improvement = ((beforeLCP - afterLCP) / beforeLCP) * 100;
  
  datadogRum.addAction('performance_optimization', {
    metric_name: 'lcp_improvement',
    before_value: beforeLCP,
    after_value: afterLCP,
    improvement_percentage: improvement,
    optimization_technique: 'web_worker_api_loading'
  });
};
```

### Dashboard Configuration
- **Key Metrics Dashboard**: LCP, FID, CLS, TTFB trends
- **Performance Alerts**: Set thresholds for regression detection
- **User Journey Analysis**: Track performance impact on conversion
- [Live Datadog Dashboard](https://app.datadoghq.com/logs?query=%22page_response_time%22&agg_m=%40loadTime&agg_m_source=base&agg_q=%40userId&agg_q_source=base&agg_t=avg&analyticsOptions=%5B%22line%22%2C%22dog_classic%22%2Cnull%2Cnull%2C%22value%22%5D&clustering_pattern_field_path=message&cols=host%2Cservice&messageDisplay=inline&refresh_mode=sliding&sort_m=%40loadTime&sort_m_source=base&sort_t=avg&storage=hot&stream_sort=time%2Cdesc&top_n=50&top_o=top&viz=timeseries&x_missing=true&from_ts=1758539140522&to_ts=1758798340522&live=true)



























# Recap
- Don't lazy load everything
- Use web workers for heavy computations/API calls
- Use coverage tab to remove unused JS
- Use CDN to serve static assets and cache it
- Measure real world performance and focus on app load time, not just LCP
